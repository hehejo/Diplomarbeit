\usepackage[utf8]{inputenc}
\usepackage{amsfonts} %defines the \frak and \Bbb commands and set up the fonts msam (extra math symbols A), msbm (extra math symbols B, and blackboard bold), eufm (Euler Fraktur), extra sizes of cmmib (bold math italic and bold lowercase Greek), and cmbsy (bold math symbols and bold script), for use in mathematics.
\usepackage{amstext} %defines the amsmath \text command.
\usepackage{amssymb} %defines the names of all the math symbols available with the AMS fonts collection
\usepackage{amsbsy} % defines the amsmath \boldsymbol and (poor mans bold) \pmb commands.
\usepackage{amscd} % defines some command for easing the generation of commutative diagrams.
\usepackage{amsmath} %\align, \subequation...

\hbadness=1000 % Gejammere ueber overfull/underfull boxes einstellbar (default=1000)

\usepackage{colortbl}%Tabellenfarben
%\usepackage{ae,aecompl}
\definecolor{black}{rgb}{0,0,0}
\usepackage{scrtime}                          % gain access to time stamps
\usepackage{scrpage2}                         % headers and footers
\usepackage{makeidx}                          % support for makeidx
\usepackage{array}                            % better table support
\usepackage{multicol}                         % spanning columns
\usepackage{multirow}                         % spanning rows
\usepackage{microtype}
\usepackage{mdwlist}
\usepackage{paralist}

\usepackage{booktabs}

\usepackage[printonlyused]{acronym}
\usepackage{subfigure}
\usepackage[ngerman,english]{babel}           % switch language
\usepackage{float}                           
\usepackage[intoc]{nomencl}                          % list of abbreviations
\usepackage{algorithmic}                      % typesetting of algorithms
\usepackage[plain,chapter]{algorithm}         % typesetting of algorithms
\usepackage{stfloats}                         % used to have footnotes at bottom of the page
\usepackage[final]{listings}                  % typesetting of code listings 

\usepackage[ngerman]{varioref} 		
\usepackage[german]{fancyref}
\newcommand*{\fancyreflstlabelprefix}{lst}
\fancyrefaddcaptions{german}{
\newcommand*{\Freflstname}{\lstlistingname}
\newcommand*{\freflstname}{\Freflstname}
}
\frefformat{vario}{\fancyreflstlabelprefix}{\Freflstname\fancyrefdefaultspacing#1#3}
\Frefformat{vario}{\fancyreflstlabelprefix}{\Freflstname\fancyrefdefaultspacing#1#3}


\usepackage{url}
\usepackage[plainpages=false, pdfpagelabels, colorlinks=true, linkcolor=black, menucolor=black, urlcolor=black, citecolor=black, pdftitle={Entwicklung eines Frameworks für die Verteilungsoptimierung in Publish/Subscribe Systemen auf Basis eines strukturierten P2P-Overlay Netzwerks}, pdfauthor={Johannes Held}, pdfsubject={Diplomarbeit}, pdfkeywords={event dissemination, p2p-overlay network, publish/subscribe system, decentralized}]{hyperref}


% macros to check whether running PDFLaTeX or not
\newif\ifpdf
\ifx\pdfoutput\undefined
\pdffalse % we are not running PDFLaTeX
\else
\pdfoutput=1 % we are running PDFLaTeX
\pdftrue
\pdfpkresolution 600
\pdfimageresolution 300
\pdfinfo{
   /Author (Johannes Held)
   /Title  (Entwicklung eines Frameworks für die Verteilungsoptimierung in Publish/Subscribe Systemen auf Basis eines strukturierten P2P-Overlay Netzwerks)
   /Subject (Diplomarbeit)
   /Keywords ()
}
\fi

% command to check draft option
\makeatletter
\newcommand*{\ifoptiondraft}{%
  \expandafter
  \@if@pti@ns\expandafter{\@classoptionslist}{final}%
  \@secondoftwo{%
    \expandafter
    \@if@pti@ns\expandafter{\@classoptionslist}{draft}%
    \@firstoftwo\@secondoftwo
  }%
}
\makeatother

\ifoptiondraft{%
  \usepackage[firsttwo,bottomafter]{draftcopy}
}


% include right printer driver for graphicx
\ifpdf
  %\usepackage[pdftex]{graphicx}
  \usepackage{pdfpages} % lädt Paket graphics selbständig
  \pdfcompresslevel=9
\else
  \usepackage[dvips]{graphicx}
\fi


\lstset{language=C++}
\lstset{basicstyle=\ttfamily\small\mdseries}
\definecolor{darkgrey}{rgb}{0.95,0.95,0.95}
\definecolor{darkgreen}{rgb}{0.3,0.6,0.3}
\definecolor{darkred}{rgb}{0.8,0.2,0.2}
\definecolor{darkblue}{rgb}{0.1,0.15,0.85}
\lstset{backgroundcolor=\color{darkgrey}}
\lstset{stringstyle=\color{darkred}}
\lstset{numberstyle=\color{darkgreen}}
\lstset{commentstyle=\color{darkgreen}}
\lstset{keywordstyle=\color{darkblue}}
\lstset{linewidth=\textwidth, showstringspaces=false}
\lstset{captionpos=b}
\lstset{tabsize=1}
\lstset{breaklines=true}
\lstset{frame=tlRb}
\lstset{frameround=fftt}
\lstset{breakatwhitespace=true}
\lstset{morekeywords={String,Class,Object}}
\lstset{numbers=left}
\lstset{float=htb}
\lstset{numberstyle=\ttfamily\tiny}
\lstset{numbersep=10pt}

% define command \missing
\newcommand{\missing}[1]{\,\,\textcolor{red}{(\marginpar[\hfill!$\longrightarrow$]{$\longleftarrow$!}{\bfseries 
    Missing:}\,\emph{#1})}\,\,}

% environment to typeset sub-figures
\newbox\subfigbox
\makeatletter
        \newenvironment{subfloat}
                {\def\caption##1{\gdef\subcapsave{\relax##1}}%
                 \let\subcapsave\@empty
                 \setbox\subfigbox\hbox
                         \bgroup}
                  {\egroup
                 \subfigure[\subcapsave]{\box\subfigbox}}
\makeatother

% define new style for TOC
\makeatletter
\renewcommand{\numberline}[1]{%
        \makebox[0.9cm][l]{#1}\hspace{1mm}}
\renewcommand{\l@chapter}[2]{%
        \addvspace{2ex}%
        \pagebreak[3]%
        \noindent%
        \makebox[0pt][l]{%
        \rule[-3pt]{\textwidth}{0pt}}%
        {\large\textsf{\textbf{#1}}}\hfill#2%
        \par%
        \nopagebreak%
        \addvspace{1ex}%
}
\renewcommand{\l@section}[2]{%
        \addvspace{0.5ex}%
        \noindent\hspace{1cm}%
        #1\dotfill#2%
        \par%
        \nopagebreak[2]%
}
\renewcommand{\l@subsection}[2]{%
        \addvspace{0.2ex}%
        \noindent\hspace{2cm}%
        #1\dotfill#2%
        \par%
}       
\makeatother

% define new style for index 
\makeatletter
\newcommand*{\heading}[1]{%
        \makebox[0pt][l]{%
                \rule[-3pt]{\linewidth}{0pt}}%
        \textsf{\textbf{\Large #1}}\hfill\nopagebreak\vspace{4pt}}
\renewenvironment{theindex}{%
        \setlength{\columnseprule}{0.4pt}
        \setlength{\columnsep}{2em}
        \begin{multicols}{2}[\chapter*{\indexname}]
                \parindent\z@
                \parskip\z@ \@plus .3\p@\relax
                \let\item\@idxitem}%
        {\end{multicols}\clearpage}
\makeatother

% page break
\clubpenalty = 10000
\widowpenalty = 10000

% prepare generation of index
\makeindex

% put footnotes below floats at the bottom
\fnbelowfloat

\setlength{\parindent}{0em}

\setcounter{topnumber}           {1}
\setcounter{bottomnumber}        {1}
\renewcommand{\floatpagefraction}{0.8}
\renewcommand{\topfraction}      {0.8}
\renewcommand{\bottomfraction}   {0.5}
\renewcommand{\textfraction}     {0.15}
\makeatletter
  \setlength{\@fptop}{0pt}
\makeatother
