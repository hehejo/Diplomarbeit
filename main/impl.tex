\chapter{Prototypische Implementierung}
\label{chap:impl}

Our prototypic implementation of the introduced models shows, the applicability of this optimization approach to a channel based publish/subscribe system. We choose C++ as language of choice and we use Chimera \cite{Allen2006Chimera}, a structured p2p-overlay system written in C. In order to minimize the overhead introduced by the flexibility of such a framework e.g. on message size or stack depth caused by function calls, we use \ac{tmp} and \emph{policy based}-design \cite{Alexandrescu2001Modern} to create the optimized channels at compile-time. The different optimization strategies for each dimension are implemented as policies encapsulating their behaviour. Each channel is therefore a template class with all dimensions as template parameters, which are instantiated with strategies for each parameter.  

With \ac{tmp} it is possible to derive create custom-tailored message headers, depending on the chosen strategies. This ensures small message sizes with a high payload ratio. Each channel itself is therefore in charge to orchestrate strategies for the different policies with regard to our processing model, derived by the semantic description for all optimization dimensions. All described design decisions ensure that the system has a small footprint at runtime and that it can be used without further knowledge of the system internals, the channels or the used strategies.

\input{main/impl_tmp.tex}

\section{Implementierungsdetails}
\subsection{Netzwerkabstraktion}
\begin{itemize*}
\item Abstrakte Basisklasse für Netzwerk
\item Abstrakte Basisklasse für Netzwerkupcalls
\item Wrapperklassen für jedes Netzwerk
\end{itemize*}


\subsection{PubSubabstraktion}
\begin{itemize*}
\item PubSubController spricht mit Netzwerk
\item PubSubSystem spricht mit Applikation und leitet Anfragen an Channel weiter
\item Channel nutzt Controller zum Netzwerkzugriff
\item $\rightarrow$ Möglichkeit verschiedene Netzwerke zu nutzen!
\end{itemize*}

\subsection{Channel}
\begin{itemize*}
\item Channel mit TMP und policy-based Design
\item viele verschiedene Strategien
\end{itemize*}

\lstinputlisting[caption={\ac{m2etis} aus Benutzersicht}, label=lst:pubsub_usage]{listings/pubsub_usage.cpp}
