\subsection{Generische KBR-API}
\label{chap:grundlagen:api}
Verschiedene Typen und Implementierungen von p2p-Netzwerke haben sehr unterschiedliche Schnittstellen zur Programmierung obwohl die Anwendungsfälle meist gleicher Art sind. Dabek moniert diese unterschiedlichen Schnittstellen der verschiedenen strukturierten p2p-Netzwerke die häufig auf dem Prinzip des \ac{kbr} agieren \cite{Dabek2003Towards}. Dies mache es aus Entwicklersicht schwer, vom Netzwerk zu abstrahieren und dieses gegebenenfalls zu wechseln. Er untersucht verschiedene strukturierte p2p-Netzwerke und identifiziert ein minimales Set von Funktionen. Diese sind in zwei Zuständigkeitsbereiche aufgeteilt: \enquote{Routing messages} und \enquote{Routing state access}.\\
Erstere umfassen drei Methoden, von denen zwei \enquote{Upcalls} sind. Ein Upcall ist ein Callback der Applikation die vom Netzwerk aufgerufen wird. \texttt{route} ermöglicht das Senden einer Nachricht. Dabei kann ein Hinweis an das Netzwerk übergeben werden, über welchen Knoten die Nachricht als nächstes geroutet werden soll. Der Upcall \texttt{forward} wird auf jedem Knoten aufgerufen, der eine Nachricht weiterleitet. Als Parameter werden der Schlüssel, die Nachricht und der nächste Routingknoten übergeben. Alle Parameter können verändert werden und der Nachrichtenversand kann auch terminiert werden. Auf dem eigentlichen Empfänger der Nachricht wird zusätzlich nach forward der Upcall \texttt{deliver} aufgerufen. Als Parameter werden der Schlüssel und die Nachricht übergeben.\\
\enquote{Routing state access} umfasst vier Methoden und einen Upcall. Dieser, \texttt{update}, informiert über Knoten die das Netzwerk betreten oder es verlassen. Um eine Liste möglicher Knoten die als möglicher nächster Routinghop in Frage kommen, wird die Methode \texttt{local\_lookup} genutzt. \texttt{neighborSet} liefert eine Liste der Nachbarn des aktuellen Knotens. Soll ein Datensatz auf mehreren Knoten gespeichert werden, ist die Methode \texttt{replicaSet} nützlich. Diese liefert für einen gegebenen Schlüssel eine Liste aller Knoten, die für den Datensatz geeignet sind. Um den Bereich zu ermitteln, für den der eigene Knoten zuständig ist, wird die Methode \texttt{range} angeboten.

Dabek zeigt, dass dieses \acf{api} ausreichend ist um darauf aufbauend verschiedene Anwendungen wie Publish/Subscribe zu implementieren und beschreibt ebenfalls wie einige Systeme -- namentlich CAN, Chord, Pastry und Tapestry -- an diese \ac{api} anpassbar sind.
