\chapter{Distributed Hashtable (DHT)}
\label{chap:dht}

Das System der \acf{dht} ist nach \cite{Wehrle2005} eine Lösung des \emph{lookup}-Problemes\footnote{``Wo speichere beziehungsweise finde ich Datensatz X?''} in verteilen Systemen ist und besticht dabei durch ihre Einfachheit, Robustheit und Skalierbarkeit. \acp{dht} können einerseits zur Speicherung von Datensätzen nach dem \emph{(key,value)}-Ansatz genutzt werden oder zum Routen von Nachrichten durch das Netzwerk. Beide Varianten schließen sich nicht gegenseitig aus. Für das System ist eine Hashfunktion $h$ definiert, so dass alle Eingaben eindeutig auf einen Wert aus dem \emph{Schlüsselraum} $S$ abgebildet werden: $h(x) \rightarrow y; y \in S$. Eine \emph{segmentierte} Hashfunktion bildet den Eingabewert auf $n$ eindeutige Schlüssel ab. Dabei ist der Schlüsselraum in $n$ disjunkte Bereiche aufteilt: $h_2(x) \rightarrow y,w; y \in S_1, w \in S_2, S := S_1 \cup S_2$. Die Wertemenge des Schlüsselraumes besteht dabei meist aus einem Intervall aus Ganzzahlen, beispielsweise von $0$ bis $2^{160}-1$. Die Hashfunktion bildet dabei die Eingaben möglichst auf den ganzen Wertebereich ab.

Jeder Knoten im Netzwerk bekommt über diese Hashfunktion einen eindeutigen Schlüssel zugeordnet. Als Eingabe der Hashfunktion kann zum Bespiel eine Kombination aus Hostnamen und Port sein. Einem Knoten wird -- je nach Netzwerk -- ein gewisser Bereich aus dem Schlüsselraum zugeordnet. Weiterhin hat jeder Knoten eine gewisse Kenntnis von andern Knoten im Netzwerk -- seine Nachbarschaft. Diese erlangt er durch netzwerkabhängige Verfahren beim Eintritt in das System\footnote{Beispiele sind in \Fref{chap:evaluation_p2p} bei der Vorstellung der verschiedenen Netzwerke Chord, Pastry und CAN gegeben.}. CAN benötigt eine an die Dimensionen angepasste segmentierte Hashfunktion zur Berechnung der Kooridinaten.

Wird das System zur Übertragung von Nachrichten genutzt, so besteht dessen minimale Schnittstelle aus den Methoden \texttt{route(key, message)} zum Senden und \texttt{receive(message)} zum Empfang von Nachrichten\footnote{Siehe \Fref{chap:grundlagen:api}}. Das System kann die Nachricht in jedem Schritt zu einem Knoten senden, der näher -- meist numerisch gesehen -- am Empfänger ist.\\
Wird das System als verteilter Datenspeicher genutzt, so wird für jeden Datensatz die selbe Hashfunktion genutzt. Beispielweise wird der Dateiname oder Dateiinhalt an die Hashfunktion übergeben. Damit kann für jeden Datensatz ein eindeutiger Schlüssel berechnet und damit der zuständige Knoten bestimmt werden. Dieser speichert den Datensatz oder hält Informationen bereit um auf den Datensatz zugreifen zu können. Die minimale Schnittstelle eines solchen Systems beschränkt sich auf die Methoden \texttt{put(key, value)} zum Speichern eines Datensatzes und \texttt{get(key)} zur Abfrage.
